<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>لوحة المدير - Dashboard</title>
<style>
body {
    margin: 0;
    font-family: 'Cairo', sans-serif;
    background-color: #111;
    color: #fff;
}
header {
    background:#111;
    color:#fff;
    padding:20px;
    text-align:center;
    border-bottom:2px solid #444;
}
header h1 {
    margin:0; 
    font-size:26px; 
    font-weight:700; 
    display:flex; 
    align-items:center; 
    justify-content:center; 
    gap:10px;
}

/* بطاقات الملخص */
.container {
    padding: 20px;
    max-width: 900px;
    margin: auto;
}
.cards-container {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
}
.card {
    flex: 1;
    padding: 15px;
    border-radius: 8px;
    text-align: center;
    color: #fff;
}
.card h3 { margin:0 0 10px 0; }
.card p { font-size:18px; font-weight:bold; margin:0; }

/* ألوان البطاقات */
#dailyCash, #dailyCard, #dailyTotal, 
#dailyTotalBookings, #dailyConfirmed, #dailyCanceled {
    background-color: #1e90ff; /* أزرق */
}
#monthCash, #monthCard, #monthTotal, 
#monthTotalBookings, #monthConfirmed, #monthCanceled {
    background-color: #ff8c00; /* برتقالي */
}

/* أزرار التنقل */
.nav-row {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
}
.nav-row button {
    flex: 1;
    padding: 15px;
    font-size: 16px;
    font-weight: bold;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    background-color: #f39c12;
    color: #111;
    transition: transform 0.1s, box-shadow 0.1s, background-color 0.3s;
}
.nav-row button:hover {
    background-color: #e67e22;
}
.nav-row button:active {
    transform: scale(1.05);
    box-shadow: 0 4px 10px rgba(0,0,0,0.4);
}

/* للجوال */
@media (max-width: 500px) {
    .cards-container, .nav-row {flex-direction: column;}
}
</style>
</head>
<body>

<!-- هيدر مع المقص فقط -->
<header>
    <h1>
        <span style="font-size:28px;">✂️</span>
        <span>لوحة تحكم الإدارة</span>
    </h1>
</header>

<div class="container">

    <h2>ملخص المبيعات</h2>
    <div class="cards-container">
        <div class="card" id="dailyCash"><h3>كاش اليوم</h3><p>0</p></div>
        <div class="card" id="dailyCard"><h3>شبكة اليوم</h3><p>0</p></div>
        <div class="card" id="dailyTotal"><h3>الإجمالي اليوم</h3><p>0</p></div>

        <div class="card" id="monthCash"><h3>كاش الشهر</h3><p>0</p></div>
        <div class="card" id="monthCard"><h3>شبكة الشهر</h3><p>0</p></div>
        <div class="card" id="monthTotal"><h3>الإجمالي الشهر</h3><p>0</p></div>
    </div>

    <h2>ملخص الحجوزات</h2>
    <div class="cards-container">
        <div class="card" id="dailyTotalBookings"><h3>إجمالي اليوم</h3><p>0</p></div>
        <div class="card" id="dailyConfirmed"><h3>مؤكد اليوم</h3><p>0</p></div>
        <div class="card" id="dailyCanceled"><h3>ملغى اليوم</h3><p>0</p></div>

        <div class="card" id="monthTotalBookings"><h3>إجمالي الشهر</h3><p>0</p></div>
        <div class="card" id="monthConfirmed"><h3>مؤكد الشهر</h3><p>0</p></div>
        <div class="card" id="monthCanceled"><h3>ملغى الشهر</h3><p>0</p></div>
    </div>

    <!-- أزرار التنقل -->
    <div class="nav-row">
        <button onclick="location.href='admin_sales.html'">متابعة المبيعات</button>
        <button onclick="location.href='admin-reservations.html'">متابعة الحجوزات</button>
        <button onclick="location.href='admin-manage.html'">إدارة الموظفين</button>
        <button onclick="location.href='index.html'">الخروج</button>
    </div>

</div>

<script>
// تحديث بطاقات المبيعات
function updateSalesCards(){
    const sales = JSON.parse(localStorage.getItem("sales")) || [];
    const today = new Date();
    const todayStr = today.toISOString().split('T')[0];
    const monthStart = new Date(today.getFullYear(), today.getMonth(), 1);
    const monthStartStr = monthStart.toISOString().split('T')[0];

    let dailyCash=0, dailyCard=0, monthCash=0, monthCard=0;

    sales.forEach(s => {
        if (s.date === todayStr){
            if(s.type==='كاش') dailyCash+=s.amount;
            if(s.type==='شبكة') dailyCard+=s.amount;
        }
        if (s.date >= monthStartStr){
            if(s.type==='كاش') monthCash+=s.amount;
            if(s.type==='شبكة') monthCard+=s.amount;
        }
    });

    document.getElementById('dailyCash').querySelector('p').innerText = dailyCash;
    document.getElementById('dailyCard').querySelector('p').innerText = dailyCard;
    document.getElementById('dailyTotal').querySelector('p').innerText = dailyCash+dailyCard;

    document.getElementById('monthCash').querySelector('p').innerText = monthCash;
    document.getElementById('monthCard').querySelector('p').innerText = monthCard;
    document.getElementById('monthTotal').querySelector('p').innerText = monthCash+monthCard;
}

// تحديث بطاقات الحجوزات
function updateBookingCards(){
    const bookings = JSON.parse(localStorage.getItem("bookings")) || [];
    const today = new Date();
    const todayStr = today.toISOString().split('T')[0];
    const monthStart = new Date(today.getFullYear(), today.getMonth(), 1);
    const monthStartStr = monthStart.toISOString().split('T')[0];

    let dailyTotal=0, dailyConfirmed=0, dailyCanceled=0;
    let monthTotal=0, monthConfirmed=0, monthCanceled=0;

    bookings.forEach(b=>{
        if(b.date===todayStr){
            dailyTotal++;
            if(b.status==='مؤكد') dailyConfirmed++;
            if(b.status==='ملغى') dailyCanceled++;
        }
        if(b.date>=monthStartStr){
            monthTotal++;
            if(b.status==='مؤكد') monthConfirmed++;
            if(b.status==='ملغى') monthCanceled++;
        }
    });

    document.getElementById('dailyTotalBookings').querySelector('p').innerText = dailyTotal;
    document.getElementById('dailyConfirmed').querySelector('p').innerText = dailyConfirmed;
    document.getElementById('dailyCanceled').querySelector('p').innerText = dailyCanceled;

    document.getElementById('monthTotalBookings').querySelector('p').innerText = monthTotal;
    document.getElementById('monthConfirmed').querySelector('p').innerText = monthConfirmed;
    document.getElementById('monthCanceled').querySelector('p').innerText = monthCanceled;
}

window.addEventListener("storage", () => {
    updateSalesCards();
    updateBookingCards();
});

updateSalesCards();
updateBookingCards();
</script>

<!-- ملفات JS القديمة -->
<script src="employee-work.js"></script>

<!-- Firebase + مزامنة LocalStorage -->
<script type="module" src="firebase-config.js"></script>
<script type="module" src="sync-firebase.js"></script>

<!-- أي كود JS يعتمد على LocalStorage -->
<script src="dashboard.js"></script>

</body>
</html>
